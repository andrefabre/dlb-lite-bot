{"ast":null,"code":"import _objectSpread from\"C:/Users/Andre/dlv-lite-bot/dlb-lite-bot/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import CryptoJS from'crypto-js';// For AES encryption\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function App(){const[tg,setTg]=useState(null);const[devMode,setDevMode]=useState(false);const[isAuthenticated,setIsAuthenticated]=useState(false);const[biometricToken,setBiometricToken]=useState('');const[assets,setAssets]=useState([]);const[newAsset,setNewAsset]=useState({type:'',details:'',notes:''});const[editingIndex,setEditingIndex]=useState(-1);const[lastAction,setLastAction]=useState('');const[lastError,setLastError]=useState('');// Helper to show alerts using Telegram SDK when available, or window.alert when not\nconst showAlert=msg=>{// Try Telegram showAlert, but fall back to window.alert and swallow WebAppMethodUnsupported\ntry{if(tg&&typeof tg.showAlert==='function'){try{tg.showAlert(msg);return;}catch(e){console.warn('tg.showAlert failed, falling back to window.alert',e);}}}catch(e){console.warn('showAlert wrapper unexpected error',e);}try{window.alert(msg);}catch(e){console.error('window.alert failed',e);}};// Safe wrappers for SecureStorage (fallback to localStorage if SecureStorage is unsupported)\nconst secureGetItem=(key,cb)=>{try{if(tg&&tg.SecureStorage&&typeof tg.SecureStorage.getItem==='function'){try{return tg.SecureStorage.getItem(key,cb);}catch(e){console.warn('tg.SecureStorage.getItem threw, falling back to localStorage',e);}}}catch(e){console.warn('secureGetItem unexpected error',e);}// async to mimic callback\nsetTimeout(()=>{try{const v=localStorage.getItem(key);cb(null,v);}catch(err){cb(err);}},0);};const secureSetItem=(key,value,cb)=>{try{if(tg&&tg.SecureStorage&&typeof tg.SecureStorage.setItem==='function'){try{return tg.SecureStorage.setItem(key,value,cb);}catch(e){console.warn('tg.SecureStorage.setItem threw, falling back to localStorage',e);}}}catch(e){console.warn('secureSetItem unexpected error',e);}setTimeout(()=>{try{localStorage.setItem(key,value);cb(null,true);}catch(err){cb(err,false);}},0);};// Promise-based wrappers around secureGetItem / secureSetItem for easier async flows\nconst secureGetItemAsync=key=>new Promise((resolve,reject)=>{try{secureGetItem(key,(err,value)=>{if(err)return reject(err);resolve(value);});}catch(e){reject(e);}});const secureSetItemAsync=(key,value)=>new Promise((resolve,reject)=>{try{secureSetItem(key,value,(err,ok)=>{if(err)return reject(err);resolve(ok);});}catch(e){reject(e);}});// Master key stored in SecureStorage (device-bound). Generate on first successful auth.\nconst MASTER_KEY_KEY='dlv_master_key';const ensureMasterKey=async()=>{try{const existing=await secureGetItemAsync(MASTER_KEY_KEY).catch(()=>null);if(existing)return existing;// generate 32 bytes random hex-ish string\nconst rand=CryptoJS.lib.WordArray.random(32).toString();await secureSetItemAsync(MASTER_KEY_KEY,rand);return rand;}catch(e){console.error('ensureMasterKey error',e);throw e;}};const getMasterKey=async()=>{const mk=await secureGetItemAsync(MASTER_KEY_KEY).catch(()=>null);return mk||null;};const encryptWithMasterKey=async data=>{const mk=await getMasterKey();if(!mk)throw new Error('master key not available');return CryptoJS.AES.encrypt(JSON.stringify(data),mk).toString();};const decryptWithMasterKey=async encrypted=>{const mk=await getMasterKey();if(!mk)throw new Error('master key not available');const bytes=CryptoJS.AES.decrypt(encrypted,mk);const txt=bytes.toString(CryptoJS.enc.Utf8);return txt?JSON.parse(txt):null;};const safeHaptic=type=>{try{tg&&tg.HapticFeedback&&typeof tg.HapticFeedback.notificationOccurred==='function'&&tg.HapticFeedback.notificationOccurred(type);}catch(e){console.warn('HapticFeedback failed',e);}};const safeClose=()=>{try{tg&&typeof tg.close==='function'&&tg.close();}catch(e){console.warn('tg.close failed',e);}};// Create a simple fake Telegram WebApp for local dev mode so UI can be tested in a browser.\nconst createFakeTelegram=()=>{const handlers={};return{themeParams:{bg_color:'#ffffff',text_color:'#000000'},ready:()=>{},expand:()=>{},onEvent:(name,cb)=>{handlers[name]=cb;},triggerEvent:(name,payload)=>{if(handlers[name])handlers[name](payload);},showAlert:text=>window.alert(text),close:()=>{},HapticFeedback:{notificationOccurred:t=>console.log('haptic',t)},SecureStorage:{getItem:(key,cb)=>{try{const v=localStorage.getItem(key);cb(null,v);}catch(e){cb(e);}},setItem:(key,value,cb)=>{try{localStorage.setItem(key,value);cb(null,true);}catch(e){cb(e,false);}}},BiometricManager:{isBiometricAvailable:true,isAccessGranted:false,init:cb=>cb&&cb(),requestAccess:(opts,cb)=>{// Simulate user granting access in dev mode\nsetTimeout(()=>cb&&cb(true),200);},authenticate:opts=>{// Simulate authentication success\nsetTimeout(()=>{const token='dev-biometric-token';setIsAuthenticated(true);setBiometricToken(token);loadAssetsWithToken(token);},200);}}};};// eslint-disable-next-line react-hooks/exhaustive-deps\nuseEffect(()=>{var _window$Telegram;// If URL contains ?dev=1 enable devMode automatically (useful on deployed preview)\ntry{const params=new URLSearchParams(window.location.search);if(params.get('dev')==='1')setDevMode(true);}catch(e){// ignore\n}const telegram=(_window$Telegram=window.Telegram)===null||_window$Telegram===void 0?void 0:_window$Telegram.WebApp;if(telegram){setTg(telegram);telegram.ready();// Hide loading spinner\ntelegram.expand();// Full height\n// Theme adaptation\ndocument.body.style.backgroundColor=telegram.themeParams.bg_color;telegram.onEvent('themeChanged',()=>{document.body.style.backgroundColor=telegram.themeParams.bg_color;});// Validate initData (send to backend for HMAC check)\nvalidateInitData(telegram.initData);// Biometric setup\nconst biometric=telegram.BiometricManager;biometric.init(()=>{if(biometric.isBiometricAvailable&&!biometric.isAccessGranted){biometric.requestAccess({reason:'Secure your asset vault'},granted=>{if(granted){authenticateBiometrics();}});}else if(biometric.isAccessGranted){authenticateBiometrics();}});telegram.onEvent('biometricAuthRequested',event=>{setIsAuthenticated(event.isAuthenticated);if(event.isAuthenticated){setBiometricToken(event.biometricToken);// Load assets after auth\nloadAssets();}});}},[]);// When devMode is toggled on in a regular browser, create fake Telegram object\n// eslint-disable-next-line react-hooks/exhaustive-deps\nuseEffect(()=>{if(devMode&&!tg){const fake=createFakeTelegram();setTg(fake);// simulate immediate auth in dev mode for convenience\nconst token='dev-biometric-token';setIsAuthenticated(true);setBiometricToken(token);// load assets from localStorage\nloadAssetsWithToken(token);}},[devMode]);// Backend validation function (call your Vercel API)\nconst validateInitData=async initData=>{if(!tg)return;// Guard for local testing\ntry{const response=await fetch('/api/validate',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({initData})});const{valid}=await response.json();if(!valid){showAlert('Invalid session! Please restart.');safeClose();}}catch(error){console.error('Validation failed',error);showAlert('Error validating session.');}};// Function to authenticate\nconst authenticateBiometrics=()=>{var _tg$BiometricManager;tg===null||tg===void 0?void 0:(_tg$BiometricManager=tg.BiometricManager)===null||_tg$BiometricManager===void 0?void 0:_tg$BiometricManager.authenticate({reason:'Unlock your vault'});};// Encryption function\nconst encryptData=function(data){let key=arguments.length>1&&arguments[1]!==undefined?arguments[1]:biometricToken;return CryptoJS.AES.encrypt(JSON.stringify(data),key).toString();};// Decryption\nconst decryptData=function(encrypted){let key=arguments.length>1&&arguments[1]!==undefined?arguments[1]:biometricToken;const bytes=CryptoJS.AES.decrypt(encrypted,key);return JSON.parse(bytes.toString(CryptoJS.enc.Utf8));};// Load assets from SecureStorage using current biometric key\nconst loadAssets=async()=>{try{const encrypted=await secureGetItemAsync('dlv_assets').catch(()=>null);if(!encrypted){setAssets([]);return;}const decrypted=await decryptWithMasterKey(encrypted);setAssets(decrypted||[]);}catch(e){console.error('loadAssets error',e);// If master key not available, assets cannot be decrypted â€” show empty\nsetAssets([]);}};// Helper kept for compatibility but now loads using master key (dev mode will generate master key)\nconst loadAssetsWithToken=async _token=>{// For MVP we will create/use a masterKey instead of token-based encryption\ntry{await ensureMasterKey();}catch(e){console.warn('Could not ensure master key in dev mode',e);}await loadAssets();};// Save assets\nconst saveAsset=()=>{setLastError('');setLastAction('saveAsset');if(!tg){setLastError('Telegram API not available');return showAlert('Telegram API not available');}if(assets.length>=10){// Limit to 10\nsetLastError('Maximum assets reached');return showAlert('Maximum 10 assets allowed');}if(editingIndex>=0){// save edit\nconst updatedAssets=assets.map((a,i)=>i===editingIndex?newAsset:a);setEditingIndex(-1);try{// persist using master key\nsetAssets(updatedAssets);setNewAsset({type:'',details:'',notes:''});(async()=>{try{const mk=await getMasterKey();if(!mk)throw new Error('master key missing');const encrypted=await encryptWithMasterKey(updatedAssets);await secureSetItemAsync('dlv_assets',encrypted);safeHaptic('success');showAlert('Asset saved!');}catch(err){console.error('SecureStorage.setItem failed',err);setLastError(err?String(err):'setItem returned false');setAssets(assets);showAlert('Failed to save asset');}})();}catch(ex){console.error('saveAsset (edit) exception',ex);setLastError(String(ex));setAssets(assets);showAlert('Failed to save asset (exception)');}return;}const updatedAssets=[...assets,newAsset];// optimistic update so UI is responsive\ntry{setAssets(updatedAssets);setNewAsset({type:'',details:'',notes:''});(async()=>{try{const mk=await getMasterKey();if(!mk)throw new Error('master key missing');const encrypted=await encryptWithMasterKey(updatedAssets);await secureSetItemAsync('dlv_assets',encrypted);safeHaptic('success');showAlert('Asset saved!');}catch(err){console.error('SecureStorage.setItem failed',err);setLastError(err?String(err):'setItem returned false');// revert optimistic update\nsetAssets(assets);showAlert('Failed to save asset');}})();}catch(ex){console.error('saveAsset exception',ex);setLastError(String(ex));setAssets(assets);showAlert('Failed to save asset (exception)');}};// Delete asset\nconst deleteAsset=index=>{setLastError('');setLastAction('deleteAsset');if(!tg){setLastError('Telegram API not available');return showAlert('Telegram API not available');}const updatedAssets=assets.filter((_,i)=>i!==index);try{// optimistic\nconst prior=assets;setAssets(updatedAssets);(async()=>{try{const mk=await getMasterKey();if(!mk)throw new Error('master key missing');const encrypted=await encryptWithMasterKey(updatedAssets);await secureSetItemAsync('dlv_assets',encrypted);showAlert('Asset deleted!');}catch(err){console.error('SecureStorage.setItem failed',err);setLastError(err?String(err):'setItem returned false');// revert\nsetAssets(prior);showAlert('Failed to delete asset');}})();}catch(ex){console.error('deleteAsset exception',ex);setLastError(String(ex));showAlert('Failed to delete asset (exception)');}};const startEdit=index=>{setEditingIndex(index);setNewAsset(assets[index]);window.scrollTo({top:0,behavior:'smooth'});};const cancelEdit=()=>{setEditingIndex(-1);setNewAsset({type:'',details:'',notes:''});};// If Telegram is not available, show a small UI to enable dev mode for local testing\nif(!tg){return/*#__PURE__*/_jsxs(\"div\",{style:{padding:20},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Lite Digital Legacy Vault\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Your app is not running inside Telegram. To test the UI in this browser, enable Dev Mode below.\"}),/*#__PURE__*/_jsxs(\"label\",{style:{display:'block',marginBottom:10},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:devMode,onChange:e=>setDevMode(e.target.checked)}),\" Enable Dev Mode\"]}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#666'},children:\"Dev Mode uses localStorage (encrypted with a temporary dev token) to simulate Telegram SecureStorage and biometrics.\"})]});}return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px',color:tg.themeParams.text_color,backgroundColor:tg.themeParams.bg_color},children:[devMode&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'#fff3bf',color:'#664d03',padding:'8px 12px',borderRadius:6,marginBottom:12,border:'1px solid #ffe58f'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Dev Mode\"}),\" \\u2014 running with a simulated Telegram API. Data is stored in localStorage.\",/*#__PURE__*/_jsx(\"button\",{onClick:()=>setDevMode(false),style:{float:'right',background:'transparent',border:'none',cursor:'pointer'},children:\"Dismiss\"})]}),devMode&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'#f6f8fa',border:'1px solid #e1e4e8',padding:12,borderRadius:6,marginBottom:12,fontSize:13},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Debug\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>{// simulate biometric auth in dev mode\nconst token='dev-biometric-token';setIsAuthenticated(true);setBiometricToken(token);loadAssetsWithToken(token);},style:{marginRight:8},children:\"Simulate Auth\"})})]}),/*#__PURE__*/_jsx(\"pre\",{style:{whiteSpace:'pre-wrap',marginTop:8},children:JSON.stringify({devMode:!!devMode,tg:!!tg,isAuthenticated,biometricToken:biometricToken?'[redacted]':'',assetsLength:assets.length,lastAction,lastError},null,2)})]}),/*#__PURE__*/_jsx(\"h1\",{children:\"Lite Digital Legacy Vault\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Store and retrieve asset info securely (no passwords/seed phrases).\"}),isAuthenticated||devMode?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Add New Asset\"}),/*#__PURE__*/_jsxs(\"select\",{value:newAsset.type,onChange:e=>setNewAsset(_objectSpread(_objectSpread({},newAsset),{},{type:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Asset Type\"}),/*#__PURE__*/_jsx(\"option\",{value:\"crypto\",children:\"Crypto\"}),/*#__PURE__*/_jsx(\"option\",{value:\"domain\",children:\"Domain\"}),/*#__PURE__*/_jsx(\"option\",{value:\"other\",children:\"Other\"})]}),/*#__PURE__*/_jsx(\"input\",{value:newAsset.details,onChange:e=>setNewAsset(_objectSpread(_objectSpread({},newAsset),{},{details:e.target.value})),placeholder:\"Details (e.g., wallet address)\",style:{width:'100%',margin:'10px 0',padding:'8px'}}),/*#__PURE__*/_jsx(\"textarea\",{value:newAsset.notes,onChange:e=>setNewAsset(_objectSpread(_objectSpread({},newAsset),{},{notes:e.target.value})),placeholder:\"Notes\",style:{width:'100%',margin:'10px 0',padding:'8px'}}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8,alignItems:'center'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:saveAsset,style:{padding:'10px 20px',margin:'10px 0'},children:editingIndex>=0?'Save Changes':'Add Asset'}),editingIndex>=0&&/*#__PURE__*/_jsx(\"button\",{onClick:cancelEdit,style:{padding:'10px 20px',margin:'10px 0'},children:\"Cancel\"})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Your Assets\"}),/*#__PURE__*/_jsx(\"ul\",{style:{listStyle:'none',padding:0},children:assets.map((asset,i)=>/*#__PURE__*/_jsxs(\"li\",{style:{margin:'10px 0',padding:'10px',border:'1px solid #ccc',borderRadius:'5px'},children:[/*#__PURE__*/_jsxs(\"strong\",{children:[asset.type,\":\"]}),\" \",asset.details,asset.notes&&/*#__PURE__*/_jsxs(\"p\",{children:[\"Notes: \",asset.notes]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'5px',display:'flex',gap:8},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>startEdit(i),children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteAsset(i),children:\"Delete\"})]})]},i))})]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"Authenticate with biometrics to access your vault.\"}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:8},children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>{try{// If BiometricManager exists, ensure access is requested first when needed\nif(tg!==null&&tg!==void 0&&tg.BiometricManager){const bm=tg.BiometricManager;if(!bm.isAccessGranted&&typeof bm.requestAccess==='function'){bm.requestAccess({reason:'Unlock your vault'},granted=>{if(granted){authenticateBiometrics();}else{showAlert('Biometric access was not granted.');}});return;}// Otherwise call authenticate directly\nauthenticateBiometrics();return;}showAlert('Biometric auth not available in this Telegram client. Try updating Telegram or enable Dev Mode to test.');}catch(e){console.error('Authenticate button error',e);showAlert('Failed to start biometric authentication.');}},children:\"Authenticate\"})})]})]});}export default App;","map":{"version":3,"names":["React","useEffect","useState","CryptoJS","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","App","tg","setTg","devMode","setDevMode","isAuthenticated","setIsAuthenticated","biometricToken","setBiometricToken","assets","setAssets","newAsset","setNewAsset","type","details","notes","editingIndex","setEditingIndex","lastAction","setLastAction","lastError","setLastError","showAlert","msg","e","console","warn","window","alert","error","secureGetItem","key","cb","SecureStorage","getItem","setTimeout","v","localStorage","err","secureSetItem","value","setItem","secureGetItemAsync","Promise","resolve","reject","secureSetItemAsync","ok","MASTER_KEY_KEY","ensureMasterKey","existing","catch","rand","lib","WordArray","random","toString","getMasterKey","mk","encryptWithMasterKey","data","Error","AES","encrypt","JSON","stringify","decryptWithMasterKey","encrypted","bytes","decrypt","txt","enc","Utf8","parse","safeHaptic","HapticFeedback","notificationOccurred","safeClose","close","createFakeTelegram","handlers","themeParams","bg_color","text_color","ready","expand","onEvent","name","triggerEvent","payload","text","t","log","BiometricManager","isBiometricAvailable","isAccessGranted","init","requestAccess","opts","authenticate","token","loadAssetsWithToken","_window$Telegram","params","URLSearchParams","location","search","get","telegram","Telegram","WebApp","document","body","style","backgroundColor","validateInitData","initData","biometric","reason","granted","authenticateBiometrics","event","loadAssets","fake","response","fetch","method","headers","valid","json","_tg$BiometricManager","encryptData","arguments","length","undefined","decryptData","decrypted","_token","saveAsset","updatedAssets","map","a","i","String","ex","deleteAsset","index","filter","_","prior","startEdit","scrollTo","top","behavior","cancelEdit","padding","children","display","marginBottom","checked","onChange","target","color","background","borderRadius","border","onClick","float","cursor","fontSize","justifyContent","alignItems","marginRight","whiteSpace","marginTop","assetsLength","_objectSpread","placeholder","width","margin","gap","listStyle","asset","bm"],"sources":["C:/Users/Andre/dlv-lite-bot/dlb-lite-bot/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport CryptoJS from 'crypto-js'; // For AES encryption\r\n\r\nfunction App() {\r\n  const [tg, setTg] = useState(null);\r\n  const [devMode, setDevMode] = useState(false);\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [biometricToken, setBiometricToken] = useState('');\r\n  const [assets, setAssets] = useState([]);\r\n  const [newAsset, setNewAsset] = useState({ type: '', details: '', notes: '' });\r\n  const [editingIndex, setEditingIndex] = useState(-1);\r\n  const [lastAction, setLastAction] = useState('');\r\n  const [lastError, setLastError] = useState('');\r\n\r\n  // Helper to show alerts using Telegram SDK when available, or window.alert when not\r\n  const showAlert = (msg) => {\r\n    // Try Telegram showAlert, but fall back to window.alert and swallow WebAppMethodUnsupported\r\n    try {\r\n      if (tg && typeof tg.showAlert === 'function') {\r\n        try {\r\n          tg.showAlert(msg);\r\n          return;\r\n        } catch (e) {\r\n          console.warn('tg.showAlert failed, falling back to window.alert', e);\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.warn('showAlert wrapper unexpected error', e);\r\n    }\r\n    try { window.alert(msg); } catch (e) { console.error('window.alert failed', e); }\r\n  };\r\n\r\n  // Safe wrappers for SecureStorage (fallback to localStorage if SecureStorage is unsupported)\r\n  const secureGetItem = (key, cb) => {\r\n    try {\r\n      if (tg && tg.SecureStorage && typeof tg.SecureStorage.getItem === 'function') {\r\n        try {\r\n          return tg.SecureStorage.getItem(key, cb);\r\n        } catch (e) {\r\n          console.warn('tg.SecureStorage.getItem threw, falling back to localStorage', e);\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.warn('secureGetItem unexpected error', e);\r\n    }\r\n    // async to mimic callback\r\n    setTimeout(() => {\r\n      try {\r\n        const v = localStorage.getItem(key);\r\n        cb(null, v);\r\n      } catch (err) {\r\n        cb(err);\r\n      }\r\n    }, 0);\r\n  };\r\n\r\n  const secureSetItem = (key, value, cb) => {\r\n    try {\r\n      if (tg && tg.SecureStorage && typeof tg.SecureStorage.setItem === 'function') {\r\n        try {\r\n          return tg.SecureStorage.setItem(key, value, cb);\r\n        } catch (e) {\r\n          console.warn('tg.SecureStorage.setItem threw, falling back to localStorage', e);\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.warn('secureSetItem unexpected error', e);\r\n    }\r\n    setTimeout(() => {\r\n      try {\r\n        localStorage.setItem(key, value);\r\n        cb(null, true);\r\n      } catch (err) {\r\n        cb(err, false);\r\n      }\r\n    }, 0);\r\n  };\r\n\r\n  // Promise-based wrappers around secureGetItem / secureSetItem for easier async flows\r\n  const secureGetItemAsync = (key) => new Promise((resolve, reject) => {\r\n    try {\r\n      secureGetItem(key, (err, value) => {\r\n        if (err) return reject(err);\r\n        resolve(value);\r\n      });\r\n    } catch (e) { reject(e); }\r\n  });\r\n\r\n  const secureSetItemAsync = (key, value) => new Promise((resolve, reject) => {\r\n    try {\r\n      secureSetItem(key, value, (err, ok) => {\r\n        if (err) return reject(err);\r\n        resolve(ok);\r\n      });\r\n    } catch (e) { reject(e); }\r\n  });\r\n\r\n  // Master key stored in SecureStorage (device-bound). Generate on first successful auth.\r\n  const MASTER_KEY_KEY = 'dlv_master_key';\r\n\r\n  const ensureMasterKey = async () => {\r\n    try {\r\n      const existing = await secureGetItemAsync(MASTER_KEY_KEY).catch(() => null);\r\n      if (existing) return existing;\r\n      // generate 32 bytes random hex-ish string\r\n      const rand = CryptoJS.lib.WordArray.random(32).toString();\r\n      await secureSetItemAsync(MASTER_KEY_KEY, rand);\r\n      return rand;\r\n    } catch (e) {\r\n      console.error('ensureMasterKey error', e);\r\n      throw e;\r\n    }\r\n  };\r\n\r\n  const getMasterKey = async () => {\r\n    const mk = await secureGetItemAsync(MASTER_KEY_KEY).catch(() => null);\r\n    return mk || null;\r\n  };\r\n\r\n  const encryptWithMasterKey = async (data) => {\r\n    const mk = await getMasterKey();\r\n    if (!mk) throw new Error('master key not available');\r\n    return CryptoJS.AES.encrypt(JSON.stringify(data), mk).toString();\r\n  };\r\n\r\n  const decryptWithMasterKey = async (encrypted) => {\r\n    const mk = await getMasterKey();\r\n    if (!mk) throw new Error('master key not available');\r\n    const bytes = CryptoJS.AES.decrypt(encrypted, mk);\r\n    const txt = bytes.toString(CryptoJS.enc.Utf8);\r\n    return txt ? JSON.parse(txt) : null;\r\n  };\r\n\r\n  const safeHaptic = (type) => {\r\n    try {\r\n      tg && tg.HapticFeedback && typeof tg.HapticFeedback.notificationOccurred === 'function' && tg.HapticFeedback.notificationOccurred(type);\r\n    } catch (e) {\r\n      console.warn('HapticFeedback failed', e);\r\n    }\r\n  };\r\n\r\n  const safeClose = () => {\r\n    try { tg && typeof tg.close === 'function' && tg.close(); } catch (e) { console.warn('tg.close failed', e); }\r\n  };\r\n\r\n  // Create a simple fake Telegram WebApp for local dev mode so UI can be tested in a browser.\r\n  const createFakeTelegram = () => {\r\n    const handlers = {};\r\n    return {\r\n      themeParams: { bg_color: '#ffffff', text_color: '#000000' },\r\n      ready: () => {},\r\n      expand: () => {},\r\n      onEvent: (name, cb) => {\r\n        handlers[name] = cb;\r\n      },\r\n      triggerEvent: (name, payload) => {\r\n        if (handlers[name]) handlers[name](payload);\r\n      },\r\n      showAlert: (text) => window.alert(text),\r\n      close: () => {},\r\n      HapticFeedback: { notificationOccurred: (t) => console.log('haptic', t) },\r\n      SecureStorage: {\r\n        getItem: (key, cb) => {\r\n          try {\r\n            const v = localStorage.getItem(key);\r\n            cb(null, v);\r\n          } catch (e) {\r\n            cb(e);\r\n          }\r\n        },\r\n        setItem: (key, value, cb) => {\r\n          try {\r\n            localStorage.setItem(key, value);\r\n            cb(null, true);\r\n          } catch (e) {\r\n            cb(e, false);\r\n          }\r\n        },\r\n      },\r\n      BiometricManager: {\r\n        isBiometricAvailable: true,\r\n        isAccessGranted: false,\r\n        init: (cb) => cb && cb(),\r\n        requestAccess: (opts, cb) => {\r\n          // Simulate user granting access in dev mode\r\n          setTimeout(() => cb && cb(true), 200);\r\n        },\r\n        authenticate: (opts) => {\r\n          // Simulate authentication success\r\n          setTimeout(() => {\r\n            const token = 'dev-biometric-token';\r\n            setIsAuthenticated(true);\r\n            setBiometricToken(token);\r\n            loadAssetsWithToken(token);\r\n          }, 200);\r\n        },\r\n      },\r\n    };\r\n  };\r\n\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  useEffect(() => {\r\n    // If URL contains ?dev=1 enable devMode automatically (useful on deployed preview)\r\n    try {\r\n      const params = new URLSearchParams(window.location.search);\r\n      if (params.get('dev') === '1') setDevMode(true);\r\n    } catch (e) {\r\n      // ignore\r\n    }\r\n\r\n    const telegram = window.Telegram?.WebApp;\r\n    if (telegram) {\r\n      setTg(telegram);\r\n      telegram.ready(); // Hide loading spinner\r\n      telegram.expand(); // Full height\r\n      // Theme adaptation\r\n      document.body.style.backgroundColor = telegram.themeParams.bg_color;\r\n      telegram.onEvent('themeChanged', () => {\r\n        document.body.style.backgroundColor = telegram.themeParams.bg_color;\r\n      });\r\n\r\n      // Validate initData (send to backend for HMAC check)\r\n      validateInitData(telegram.initData);\r\n\r\n      // Biometric setup\r\n      const biometric = telegram.BiometricManager;\r\n      biometric.init(() => {\r\n        if (biometric.isBiometricAvailable && !biometric.isAccessGranted) {\r\n          biometric.requestAccess({ reason: 'Secure your asset vault' }, (granted) => {\r\n            if (granted) {\r\n              authenticateBiometrics();\r\n            }\r\n          });\r\n        } else if (biometric.isAccessGranted) {\r\n          authenticateBiometrics();\r\n        }\r\n      });\r\n\r\n      telegram.onEvent('biometricAuthRequested', (event) => {\r\n        setIsAuthenticated(event.isAuthenticated);\r\n        if (event.isAuthenticated) {\r\n          setBiometricToken(event.biometricToken);\r\n          // Load assets after auth\r\n          loadAssets();\r\n        }\r\n      });\r\n    }\r\n  }, []);\r\n\r\n  // When devMode is toggled on in a regular browser, create fake Telegram object\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  useEffect(() => {\r\n    if (devMode && !tg) {\r\n      const fake = createFakeTelegram();\r\n      setTg(fake);\r\n      // simulate immediate auth in dev mode for convenience\r\n      const token = 'dev-biometric-token';\r\n      setIsAuthenticated(true);\r\n      setBiometricToken(token);\r\n      // load assets from localStorage\r\n      loadAssetsWithToken(token);\r\n    }\r\n  }, [devMode]);\r\n\r\n  // Backend validation function (call your Vercel API)\r\n  const validateInitData = async (initData) => {\r\n    if (!tg) return; // Guard for local testing\r\n    try {\r\n      const response = await fetch('/api/validate', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ initData }),\r\n      });\r\n      const { valid } = await response.json();\r\n      if (!valid) {\r\n        showAlert('Invalid session! Please restart.');\r\n        safeClose();\r\n      }\r\n    } catch (error) {\r\n      console.error('Validation failed', error);\r\n      showAlert('Error validating session.');\r\n    }\r\n  };\r\n\r\n  // Function to authenticate\r\n  const authenticateBiometrics = () => {\r\n    tg?.BiometricManager?.authenticate({ reason: 'Unlock your vault' });\r\n  };\r\n\r\n  // Encryption function\r\n  const encryptData = (data, key = biometricToken) => {\r\n    return CryptoJS.AES.encrypt(JSON.stringify(data), key).toString();\r\n  };\r\n\r\n  // Decryption\r\n  const decryptData = (encrypted, key = biometricToken) => {\r\n    const bytes = CryptoJS.AES.decrypt(encrypted, key);\r\n    return JSON.parse(bytes.toString(CryptoJS.enc.Utf8));\r\n  };\r\n\r\n  // Load assets from SecureStorage using current biometric key\r\n  const loadAssets = async () => {\r\n    try {\r\n      const encrypted = await secureGetItemAsync('dlv_assets').catch(() => null);\r\n      if (!encrypted) {\r\n        setAssets([]);\r\n        return;\r\n      }\r\n      const decrypted = await decryptWithMasterKey(encrypted);\r\n      setAssets(decrypted || []);\r\n    } catch (e) {\r\n      console.error('loadAssets error', e);\r\n      // If master key not available, assets cannot be decrypted â€” show empty\r\n      setAssets([]);\r\n    }\r\n  };\r\n\r\n  // Helper kept for compatibility but now loads using master key (dev mode will generate master key)\r\n  const loadAssetsWithToken = async (_token) => {\r\n    // For MVP we will create/use a masterKey instead of token-based encryption\r\n    try {\r\n      await ensureMasterKey();\r\n    } catch (e) {\r\n      console.warn('Could not ensure master key in dev mode', e);\r\n    }\r\n    await loadAssets();\r\n  };\r\n\r\n  // Save assets\r\n  const saveAsset = () => {\r\n    setLastError('');\r\n    setLastAction('saveAsset');\r\n    if (!tg) {\r\n      setLastError('Telegram API not available');\r\n      return showAlert('Telegram API not available');\r\n    }\r\n    if (assets.length >= 10) { // Limit to 10\r\n      setLastError('Maximum assets reached');\r\n      return showAlert('Maximum 10 assets allowed');\r\n    }\r\n    if (editingIndex >= 0) {\r\n      // save edit\r\n      const updatedAssets = assets.map((a, i) => i === editingIndex ? newAsset : a);\r\n      setEditingIndex(-1);\r\n      try {\r\n        // persist using master key\r\n        setAssets(updatedAssets);\r\n        setNewAsset({ type: '', details: '', notes: '' });\r\n        (async () => {\r\n          try {\r\n            const mk = await getMasterKey();\r\n            if (!mk) throw new Error('master key missing');\r\n            const encrypted = await encryptWithMasterKey(updatedAssets);\r\n            await secureSetItemAsync('dlv_assets', encrypted);\r\n            safeHaptic('success');\r\n            showAlert('Asset saved!');\r\n          } catch (err) {\r\n            console.error('SecureStorage.setItem failed', err);\r\n            setLastError(err ? String(err) : 'setItem returned false');\r\n            setAssets(assets);\r\n            showAlert('Failed to save asset');\r\n          }\r\n        })();\r\n      } catch (ex) {\r\n        console.error('saveAsset (edit) exception', ex);\r\n        setLastError(String(ex));\r\n        setAssets(assets);\r\n        showAlert('Failed to save asset (exception)');\r\n      }\r\n      return;\r\n    }\r\n    const updatedAssets = [...assets, newAsset];\r\n    // optimistic update so UI is responsive\r\n    try {\r\n      setAssets(updatedAssets);\r\n      setNewAsset({ type: '', details: '', notes: '' });\r\n      (async () => {\r\n        try {\r\n          const mk = await getMasterKey();\r\n          if (!mk) throw new Error('master key missing');\r\n          const encrypted = await encryptWithMasterKey(updatedAssets);\r\n          await secureSetItemAsync('dlv_assets', encrypted);\r\n          safeHaptic('success');\r\n          showAlert('Asset saved!');\r\n        } catch (err) {\r\n          console.error('SecureStorage.setItem failed', err);\r\n          setLastError(err ? String(err) : 'setItem returned false');\r\n          // revert optimistic update\r\n          setAssets(assets);\r\n          showAlert('Failed to save asset');\r\n        }\r\n      })();\r\n    } catch (ex) {\r\n      console.error('saveAsset exception', ex);\r\n      setLastError(String(ex));\r\n      setAssets(assets);\r\n      showAlert('Failed to save asset (exception)');\r\n    }\r\n  };\r\n\r\n  // Delete asset\r\n  const deleteAsset = (index) => {\r\n    setLastError('');\r\n    setLastAction('deleteAsset');\r\n    if (!tg) {\r\n      setLastError('Telegram API not available');\r\n      return showAlert('Telegram API not available');\r\n    }\r\n    const updatedAssets = assets.filter((_, i) => i !== index);\r\n    try {\r\n      // optimistic\r\n      const prior = assets;\r\n      setAssets(updatedAssets);\r\n      (async () => {\r\n        try {\r\n          const mk = await getMasterKey();\r\n          if (!mk) throw new Error('master key missing');\r\n          const encrypted = await encryptWithMasterKey(updatedAssets);\r\n          await secureSetItemAsync('dlv_assets', encrypted);\r\n          showAlert('Asset deleted!');\r\n        } catch (err) {\r\n          console.error('SecureStorage.setItem failed', err);\r\n          setLastError(err ? String(err) : 'setItem returned false');\r\n          // revert\r\n          setAssets(prior);\r\n          showAlert('Failed to delete asset');\r\n        }\r\n      })();\r\n    } catch (ex) {\r\n      console.error('deleteAsset exception', ex);\r\n      setLastError(String(ex));\r\n      showAlert('Failed to delete asset (exception)');\r\n    }\r\n  };\r\n\r\n  const startEdit = (index) => {\r\n    setEditingIndex(index);\r\n    setNewAsset(assets[index]);\r\n    window.scrollTo({ top: 0, behavior: 'smooth' });\r\n  };\r\n\r\n  const cancelEdit = () => {\r\n    setEditingIndex(-1);\r\n    setNewAsset({ type: '', details: '', notes: '' });\r\n  };\r\n\r\n  // If Telegram is not available, show a small UI to enable dev mode for local testing\r\n  if (!tg) {\r\n    return (\r\n      <div style={{ padding: 20 }}>\r\n        <h1>Lite Digital Legacy Vault</h1>\r\n        <p>Your app is not running inside Telegram. To test the UI in this browser, enable Dev Mode below.</p>\r\n        <label style={{ display: 'block', marginBottom: 10 }}>\r\n          <input type=\"checkbox\" checked={devMode} onChange={(e) => setDevMode(e.target.checked)} /> Enable Dev Mode\r\n        </label>\r\n        <p style={{ color: '#666' }}>\r\n          Dev Mode uses localStorage (encrypted with a temporary dev token) to simulate Telegram SecureStorage and biometrics.\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div style={{ padding: '20px', color: tg.themeParams.text_color, backgroundColor: tg.themeParams.bg_color }}>\r\n      {devMode && (\r\n        <div style={{ background: '#fff3bf', color: '#664d03', padding: '8px 12px', borderRadius: 6, marginBottom: 12, border: '1px solid #ffe58f' }}>\r\n          <strong>Dev Mode</strong> â€” running with a simulated Telegram API. Data is stored in localStorage.\r\n          <button onClick={() => setDevMode(false)} style={{ float: 'right', background: 'transparent', border: 'none', cursor: 'pointer' }}>Dismiss</button>\r\n        </div>\r\n      )}\r\n      {devMode && (\r\n        <div style={{ background: '#f6f8fa', border: '1px solid #e1e4e8', padding: 12, borderRadius: 6, marginBottom: 12, fontSize: 13 }}>\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n            <strong>Debug</strong>\r\n            <div>\r\n              <button onClick={() => {\r\n                // simulate biometric auth in dev mode\r\n                const token = 'dev-biometric-token';\r\n                setIsAuthenticated(true);\r\n                setBiometricToken(token);\r\n                loadAssetsWithToken(token);\r\n              }} style={{ marginRight: 8 }}>Simulate Auth</button>\r\n            </div>\r\n          </div>\r\n          <pre style={{ whiteSpace: 'pre-wrap', marginTop: 8 }}>\r\n{JSON.stringify({ devMode: !!devMode, tg: !!tg, isAuthenticated, biometricToken: biometricToken ? '[redacted]' : '', assetsLength: assets.length, lastAction, lastError }, null, 2)}\r\n          </pre>\r\n        </div>\r\n      )}\r\n      <h1>Lite Digital Legacy Vault</h1>\r\n      <p>Store and retrieve asset info securely (no passwords/seed phrases).</p>\r\n  {(isAuthenticated || devMode) ? (\r\n        <>\r\n          <h2>Add New Asset</h2>\r\n          <select value={newAsset.type} onChange={(e) => setNewAsset({ ...newAsset, type: e.target.value })}>\r\n            <option value=\"\">Asset Type</option>\r\n            <option value=\"crypto\">Crypto</option>\r\n            <option value=\"domain\">Domain</option>\r\n            <option value=\"other\">Other</option>\r\n          </select>\r\n          <input\r\n            value={newAsset.details}\r\n            onChange={(e) => setNewAsset({ ...newAsset, details: e.target.value })}\r\n            placeholder=\"Details (e.g., wallet address)\"\r\n            style={{ width: '100%', margin: '10px 0', padding: '8px' }}\r\n          />\r\n          <textarea\r\n            value={newAsset.notes}\r\n            onChange={(e) => setNewAsset({ ...newAsset, notes: e.target.value })}\r\n            placeholder=\"Notes\"\r\n            style={{ width: '100%', margin: '10px 0', padding: '8px' }}\r\n          />\r\n          <div style={{ display: 'flex', gap: 8, alignItems: 'center' }}>\r\n            <button onClick={saveAsset} style={{ padding: '10px 20px', margin: '10px 0' }}>{editingIndex >= 0 ? 'Save Changes' : 'Add Asset'}</button>\r\n            {editingIndex >= 0 && <button onClick={cancelEdit} style={{ padding: '10px 20px', margin: '10px 0' }}>Cancel</button>}\r\n          </div>\r\n          <h2>Your Assets</h2>\r\n          <ul style={{ listStyle: 'none', padding: 0 }}>\r\n            {assets.map((asset, i) => (\r\n              <li key={i} style={{ margin: '10px 0', padding: '10px', border: '1px solid #ccc', borderRadius: '5px' }}>\r\n                <strong>{asset.type}:</strong> {asset.details}\r\n                {asset.notes && <p>Notes: {asset.notes}</p>}\r\n                <div style={{ marginTop: '5px', display: 'flex', gap: 8 }}>\r\n                  <button onClick={() => startEdit(i)}>Edit</button>\r\n                  <button onClick={() => deleteAsset(i)}>Delete</button>\r\n                </div>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </>\r\n      ) : (\r\n        <div>\r\n          <p>Authenticate with biometrics to access your vault.</p>\r\n          <div style={{ marginTop: 8 }}>\r\n            <button onClick={() => {\r\n              try {\r\n                // If BiometricManager exists, ensure access is requested first when needed\r\n                if (tg?.BiometricManager) {\r\n                  const bm = tg.BiometricManager;\r\n                  if (!bm.isAccessGranted && typeof bm.requestAccess === 'function') {\r\n                    bm.requestAccess({ reason: 'Unlock your vault' }, (granted) => {\r\n                      if (granted) {\r\n                        authenticateBiometrics();\r\n                      } else {\r\n                        showAlert('Biometric access was not granted.');\r\n                      }\r\n                    });\r\n                    return;\r\n                  }\r\n                  // Otherwise call authenticate directly\r\n                  authenticateBiometrics();\r\n                  return;\r\n                }\r\n                showAlert('Biometric auth not available in this Telegram client. Try updating Telegram or enable Dev Mode to test.');\r\n              } catch (e) {\r\n                console.error('Authenticate button error', e);\r\n                showAlert('Failed to start biometric authentication.');\r\n              }\r\n            }}>Authenticate</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}